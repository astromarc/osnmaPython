import hmac
from bitarray import bitarray
from bitarray.util import int2ba, ba2int, hex2ba, ba2hex


satID = 14
CTR = 1

key = bitarray('00001111010111100100100111011101100110110111010101100111000110100011111100110111101111100011101001000111011110111000001101100010')
print(ba2hex(key))

PRNA = int2ba(satID,8)
GST = bitarray('01001001001000111011010001001000')
CTR_ba = int2ba(CTR,8)
NMAS = bitarray('01')
NavData = bitarray('000001001100111110111110000001000011001010111011010111010101001110011101110001001000111110100101010010101100001001110110000001001110011000101110011001111101101100001000111101011110001101101011000101010100111011101111111100000100011010111110000001001111111111101010110001000000110111010100101111010110000000000010010000011100100000000101001111100011100110011010110000010011001110000000111111111011110101110101110011111011111011111100011110001100010101010111111111111100010110110000000010111011111111000101111111000100100000011111101001111110010010100')

print("PRNA:", PRNA)
print("GST:", GST)
print("CTR:", CTR_ba)
print("NMAS:", NMAS)
m = PRNA+GST+NMAS+CTR_ba+NavData
m.fill()


h = bitarray()

h.frombytes(hmac.digest(key.tobytes(), m.tobytes(), 'sha256'))

h = h[:40]

print("Computed hash:", ba2hex(h))